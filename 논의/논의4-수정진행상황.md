# ë…¼ì˜4: ìˆ˜ì • ì§„í–‰ ìƒí™©

**ë‚ ì§œ**: 2025-12-16
**ì‹œê°„**: ì§„í–‰ ì¤‘

---

## âœ… ì™„ë£Œëœ ìˆ˜ì •

### 1. í•«í‚¤ ë¬¸ì œ í•´ê²° âœ…

**ë³€ê²½ ì‚¬í•­**:
```typescript
// CouncilView.ts - ìƒˆë¡œìš´ ë©”ì„œë“œ ì¶”ê°€
async refreshContext() {
  await this.updateContext();
  new Notice('Context updated');
}

// main.ts - activateView ìˆ˜ì •
async activateView() {
  // ... existing code ...

  // If view was already open, refresh context
  if (wasAlreadyOpen && leaf.view instanceof CouncilView) {
    await (leaf.view as CouncilView).refreshContext();
  }
}
```

**ê²°ê³¼**:
- âœ… Vault Councilì´ ì—´ë ¤ìˆëŠ” ìƒíƒœì—ì„œ
- âœ… ë‹¤ë¥¸ íŒŒì¼ë¡œ ì´ë™ í›„
- âœ… í•«í‚¤ë¥¼ ëˆ„ë¥´ë©´
- âœ… ìë™ìœ¼ë¡œ í˜„ì¬ íŒŒì¼ì˜ ì»¨í…ìŠ¤íŠ¸ë¡œ ì—…ë°ì´íŠ¸ë¨
- âœ… "Context updated" ì•Œë¦¼ í‘œì‹œ

---

### 2. ë³¼íŠ¸ ì „í™˜ ë²„íŠ¼ ê°œì„  âœ…

**ë³€ê²½ ì‚¬í•­**:
```typescript
switchBtn.addEventListener('click', () => {
  const commands = (this.app as any).commands;
  if (commands && commands.executeCommandById) {
    try {
      // Try to open vault switcher
      commands.executeCommandById('app:open-vault');
    } catch (e) {
      // Fallback to command palette
      commands.executeCommandById('command-palette:open');
      new Notice('Search for "Open another vault" in the palette');
    }
  }
});
```

**ê²°ê³¼**:
- âœ… ë²ˆê°œ(âš¡) ë²„íŠ¼ í´ë¦­ ì‹œ
- âœ… `app:open-vault` ëª…ë ¹ ì‹œë„
- âœ… ì‹¤íŒ¨ ì‹œ Command Palette ì—´ë¦¼
- âœ… ì‚¬ìš©ìê°€ "Open another vault" ê²€ìƒ‰ ê°€ëŠ¥

---

## â³ ì§„í–‰ ì¤‘

### 3. Custom Mode êµ¬í˜„ (í˜„ì¬ ì‘ì—… ì¤‘)

**í•„ìš”í•œ êµ¬í˜„**:

#### A. íŒŒì¼ ì„ íƒ Modal ìƒì„±
```typescript
import { SuggestModal, TFile } from 'obsidian';

class FileSelectorModal extends SuggestModal<TFile> {
  // íŒŒì¼ ê²€ìƒ‰ ë° ì„ íƒ UI
}
```

#### B. ì„ íƒëœ íŒŒì¼ ê´€ë¦¬
```typescript
// CouncilViewì— ì¶”ê°€
selectedCustomFiles: TFile[] = [];

addCustomFile(file: TFile) {
  if (!this.selectedCustomFiles.includes(file)) {
    this.selectedCustomFiles.push(file);
    this.refreshContext();
  }
}

removeCustomFile(file: TFile) {
  const index = this.selectedCustomFiles.indexOf(file);
  if (index > -1) {
    this.selectedCustomFiles.splice(index, 1);
    this.refreshContext();
  }
}
```

#### C. UI ì¶”ê°€
- "Select Files" ë²„íŠ¼ (Custom Modeì¼ ë•Œë§Œ í‘œì‹œ)
- ì„ íƒëœ íŒŒì¼ ëª©ë¡ í‘œì‹œ
- íŒŒì¼ ì œê±° ë²„íŠ¼

#### D. ì»¨í…ìŠ¤íŠ¸ ìˆ˜ì§‘ ìˆ˜ì •
```typescript
else if (contextMode === 'custom') {
  // Use manually selected files
  for (const file of this.selectedCustomFiles) {
    const content = await this.app.vault.read(file);
    linkedFiles.push(`File: ${file.basename}\n${content}`);
  }
}
```

---

## ğŸ“ ë‹¤ìŒ ë‹¨ê³„

1. FileSelectorModal í´ë˜ìŠ¤ ìƒì„±
2. CouncilViewì— íŒŒì¼ ì„ íƒ ë²„íŠ¼ ì¶”ê°€
3. ì„ íƒëœ íŒŒì¼ ëª©ë¡ UI êµ¬í˜„
4. gatherContext() ìˆ˜ì •í•˜ì—¬ custom mode ì™„ì„±
5. í…ŒìŠ¤íŠ¸ ë° ë¹Œë“œ
6. v0.3.2 ë¦´ë¦¬ì¦ˆ

---

**ê³„ì† ì§„í–‰ ì¤‘...**
